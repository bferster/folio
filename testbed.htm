<!DOCTYPE html>
<html>
<head>
	<title>SHANTI Folio testbed</title>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>	
	<style>
		 body { 		font-family:Verdana,Geneva,sans-serif;font-size:12px;padding:0px; }
		.editor { 		width:100%;height:75vh; }
		.send { 		width:150px;margin:8px;padding-left:8px;font-family:monospace; }
		.response { 	width:50%;height:60px;border:1px solid #999;width:50%;padding:8px;margin:8px;font-family:monospace;overflow:auto }
	</style>

</head>

<body>
		<iframe class='editor' id='folio' frameborder='0'src='index.html'></iframe>
		<br>&nbsp; Type message to send (command|params): 
		<input type='text' class='send' type='text' id='sendToFolio'><br>
		<div class='response' id='fResponse'></div>
</body>	

<script>

	$(document).ready(function() {											// ON PAGE LOADED
		if (window.addEventListener) 										// If supported this way
			window.addEventListener("message",eventHandler,false);			// Add event handler
		else																// Use other method
			window.attachEvent("message",eventHandler);						// Add handler

	$("#sendToFolio").on("change",function() {
		var v=$(this).val().split("|");										// Split in command and payload
		SendMessage(v[0],v[1]);												// Send to folio
		});
	
	});									

	function eventHandler(e)											// ON HTML5 MESSAGE
	{
 		if (e && e.data)													// If message
 			if (!e.data.match(/|Folio/))									// Not from Folio
 				return;														// Quit
  		$("#fResponse").html($("#fResponse").html()+e.data+"<br>");			// Show new message
 	}
 
	function SendMessage(cmd, msg) 										// SEND HTML5 MESSAGE 
	{
		var str=cmd+"|Mandala";												// Add src and window						
		if (msg)															// If more to it
			str+="|"+msg;													// Add it
			$("#folio")[0].contentWindow.postMessage(str,"*");				// Send data to wind
	}

</script>

</html>