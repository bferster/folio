<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
	<link REL="SHORTCUT ICON" HREF="shanti.ico">
	<title>SHANTI folio</title>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>	
	<link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.css" />
	<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
	<script src="ckeditor/ckeditor.js"></script>

	<style type="text/css">
		body { 			font-family:Verdana,Geneva,sans-serif;font-size:12px;
						padding:0px;border:0px;
						}
		.sf-main {		
						}
		.sf-menu {		width:100%;height:30px;color:#666;border:2px solid #ddd;
						background-color:#ddd;opacity:inherit;
						border-top-left-radius:6px;border-top-right-radius:6px;
						}
		.sf-body {		width:100%;min-height:300px;color:#666;border:2px solid #ddd;
						background-color:#fff;opacity:inherit;
						}
		.sf-menuItem {	margin-left:50px;cursor:pointer;
						}
		.sf-menuItem:hover { color:#00aa00;
						}
		.sf-breadItem {	text-align:left;float:right;margin-right:12px;margin-top:8px;
						color:#888;
						}
		.sf-is {		border-radius:10px;padding-left:8px;padding-right:8px;padding-top:1px;
						border:1px solid #ccc;font-size:12px;height;24px;width:95%;color:#999;
						}
		.sf-bs {		border-radius:10px;padding-left:8px;padding-right:8px;padding-top:1px;color:#009900;
						border:1px solid #ccc;font-size:12px;height;24px;background-color:#fff;cursor:pointer;
						}
		.sf-gallery {  	display:inline-block;text-align:center;padding:12px;padding-top:0px;padding-bottom:8px;
						height:100%-60;background-color:#ddd;vertical-align:middle;color:#999;width:150px;
						}
		.sf-galleryContent { overflow-x:hidden;overflow-y:auto;background-color:#f8f8f8;
						border:1px solid #bbb;width:100%;
						}
		.sf-galleryLab  { padding:8px;border-bottom:1px solid #999;text-align:center;
						height:40px;background-color:#f8f8f8;
						}
		.sf-galleryTool { text-align:left;padding-top:3px;
						}
		.sf-galleryBut  { cursor:pointer;margin-right:25px;
						}
		.sf-projectPage { position:absolute;overflow-x:hidden;overflow-y:auto;top:44px;left:184px;
						width:400px;margin:12px;color:#aaa;border-right:1px solid #ccc;
						padding-right:16px;
						}
		.sf-itemsPicker { position:absolute;overflow-x:hidden;overflow-y:auto;top:44px;left:616px;
						margin:12px;color:#aaa;text-align:left;
						}
		.sf-item	    { display:inline-block;width:128px;height:64px;margin-bottom:36px;margin-right:16px;
						}
		.sf-itemPic    { width:128px;height:64px;border:1px solid #ccc;cursor:pointer;
						}
		.sf-projectItems {
						border-top:1px solid #ccc;width:100%;text-align:center;color:#ccc;
						}

		.unselectable { -moz-user-select: none;     -khtml-user-select: none;
		   			 	-webkit-user-select: none;  -ms-user-select: none;   user-select: none;
		   				}
		.selectable { 	-moz-user-select: text;     -khtml-user-select: text;
		   			 	-webkit-user-select: text;  -ms-user-select: text;   user-select: text;
		   				}
	</style>
</head>
<body>
	<div id="mainDiv" class="sf-main unselectable" style="opacity:0">	
		<div id="menuDiv" class="sf-menu">
			<img src="img/menuheader.png">
			<span style="vertical-align:10px">
				S H A N T l
				<span id="editMenu" class="sf-menuItem" style="margin-left:100px"> Edit</span>
				<span id="projectMenu" class="sf-menuItem"> Project</span>
				<span id="viewMenu" class="sf-menuItem">View</span>
				<span id="pageMenu" class="sf-menuItem">Page</span>
				<span id="helpMenu" class="sf-menuItem">Help</span>
				<div id="breadMenu" class="sf-breadItem"><b>Project:</b></div>
			</span>
		</div>
		<div id="bodyDiv" class="sf-body"></div>
	</div>	
<script>

//////////////////////////////////////////////////////////////////////////////////////////////////
// MAIN 
/////////////////////////////////////////////////////////////////////////////////////////////////

var sf=null;															// Holds main folio object									
		
$(window).resize(function() {											// ON WINDOW RESIZE
	if (sf)																	// If loaded
		sf.Draw();															// Redraw to adjust responsivivly
	});
			
$(document).ready(function() {											// ON PAGE LOADED
 	new folio();															// Load main object
	$("#mainDiv").animate({ opacity:1},1000, function() {				
		$("#mainDiv").css("opacity",1);
		});				 
	$("#projectMenu").on("click",function() { 
		sf.page="project";
		Sound("click");												
		sf.Draw();
		});
	$("#viewMenu").on("click",function() { 
		sf.page="view";
		Sound("click");												
		sf.Draw();
		});
	$("#pageMenu").on("click",function() { 
		sf.page="page";
		Sound("click");												
		sf.Draw();
		});
	$("#helpMenu").on("click",function() { 
		sf.page="help";
		Sound("click");												
		sf.Draw();
		});
	$("#editMenu").on("click",function() { 
		sf.page="edit";
		Sound("click");												
		sf.Draw();
		});
	});									
		
function folio()														// CONSTRUCTOR
{
	sf=this;																// Point to folio
	this.changed=false;														// No changes yet
	this.curProject=this.curView=this.curPage=-1;							// Assume not chosen
	this.queryString=window.location.search.substring(1);					// Get query string
	this.InitFolio("");														// Init project
	this.page="project";													// Init as project page
	this.Draw();															// Draw 
	}	

folio.prototype.InitFolio=function(data)								// INIT 
{
	this.curProject=0;
	this.firstName="Teresa";
	this.lastName="Sullivan";
}

folio.prototype.Draw=function()											// DRAW PAGE
{
	var h=window.innerHeight;												// Get height
	var w=window.innerWidth;												// Get width
	$("#bodyDiv").height(h-54);												// Set body height
	this.DrawMenu();														// Set menu
	this.DrawBody();														// Draw body
	$("#projectDiv").height(h-78);											// Set project height
	$("#itemPickerDiv").height(h-78);										// Set picker width height
	$("#itemPickerDiv").width(w-648);										// Set picker width 
}
		
	
folio.prototype.DrawMenu=function()										// DRAW MENU AREA
{
	$("#projectMenu").css("color","#000000");								// Reset
	$("#viewMenu").css("color","#000000");									// Reset
	$("#pageMenu").css("color","#000000");									// Reset
	var str="<b>"+this.firstName+" "+this.lastName+"</b>";					// Add name
	
	if (this.page == "project")	{											// If project
		$("#projectMenu").css("color","#00aa00");							// Highlight it
		str+=" &nbsp;|&nbsp; ";												// Add to breadcrumb
		if ((this.curProject != -1) && projects[this.curProject].title)		// A valid project
			str+=ShortenString(projects[this.curProject].title,20);			// Add title
		}
	else if (this.page == "view") {											// If view
		$("#viewMenu").css("color","#00aa00");								// Highlight it
		str+="&nbsp;|&nbsp; ";												// Add to breadcrumb
		if ((this.curProject != -1) && projects[this.curProject].title)		// A valid project
			str+=ShortenString(projects[this.curProject].title,20);			// Add title
		str+=" &nbsp;|&nbsp; My view";										// Add to breadcrumb
		}
	else if (this.page == "page") {											// If page
		$("#pageMenu").css("color","#00aa00");								// Highlight it
		str+="&nbsp;|&nbsp; ";												// Add to breadcrumb
		if ((this.curProject != -1) && projects[this.curProject].title)		// A valid project
			str+=ShortenString(projects[this.curProject].title,20);			// Add title
		str+=" &nbsp;|&nbsp; My view &nbsp;|&nbsp; 1";						// Add to breadcrumb
		}
	$("#breadMenu").html(str);												// Set breadcrumb
}

folio.prototype.DrawBody=function()										// DRAW BODY AREA
{
	var str="<br>"
	str=MakeGallery();														// Add Gallery
	if (this.page == "project") {											// If a project
		str+=this.MakeProjectPage();										// Add project page
		str+=this.MakeItemsPicker();										// Add project items picker
		}
	$("#bodyDiv").html(str);
	if (this.page == "project")	{											// If a project
		$("#pTitle").on("change",function() { 								// If changed
			projects[sf.curProject].title=$("#pTitle").val();				// Set it	
			sf.changed=true;												// Something changed
			});
		
		$("#pDesc").on("change",function() { 								// If changed
			projects[sf.curProject].desc=$("#pDesc").val();					// Set it	
			sf.changed=true;												// Something changed
			});
		
		$("#pCite").on("change",function() { 								// If changed
			projects[sf.curProject].cite=$("#pCite").val();					// Set it	
			sf.changed=true;												// Something changed
			});
		
		$("#pTags").on("change",function() { 								// If changed
			projects[sf.curProject].tags=$("#pTags").val();					// Set it	
			sf.changed=true;												// Something changed
			});
		
		for (i=0;i<projects.length;++i)										// For each project
			$("#galleryLab"+i).on("click", function(e) {					// ON PROJECT CLICK
				sf.curProject=e.currentTarget.id.substr(10)-0;				// Extract id
				Sound("click");												// Click
				sf.Draw();													// Redraw
				});

		$("#galleryAddBut").on("click",function() { 						// ADD NEW PROJECT
			projects.push({ title:"New project" });							// Add shell					
			sf.curProject=projects.length-1;								// Point at it
			Sound("ding");													// Ding
			sf.changed=true;												// Something changed
			sf.Draw();														// Redraw
			});
		
		$("#galleryTrashBut").on("click",function() { 						// DELETE PROJECT
				ConfirmBox("This will delete the project:<br><br><b><i>"+projects[sf.curProject].title+"</b></i>", function() {
				projects.splice(sf.curProject,1);							// Remove it
				sf.curProject--;											// Go to previous projcet
				Sound("delete");											// Delete
				sf.changed=true;											// Something changed
				sf.Draw();													// Redraw
				});
			});

		$("#collabAddBut").on("click",function() { 							// ADD NEW COLLABORATOR
 			GetTextBox("Type name of collaborator", "", "", function(s) {	// Ask for name
				if (projects[sf.curProject].collab)							// If not first one
					projects[sf.curProject].collab+=","+s;					// Add new collaborator
				else														// Frist one one
					projects[sf.curProject].collab=s;						// Add first collaborator
				Sound("ding");												// Ding
				sf.changed=true;											// Something changed
				sf.Draw();													// Redraw
				$("#pCollab").val(s);
			});
		});

		$("#collabTrashBut").on("click",function() { 						// DELETE PROJECT
				var s=$("#pCollab").val();
				if (!s)														// Nothing selected
					return;													// Quit
			ConfirmBox("This will delete <b>"+s+" </b>from the project", function() {
				var v=projects[sf.curProject].collab.split(",");			// Make into array		
				v.splice($("#pCollab").prop('selectedIndex'),1);			// Delete it
				projects[sf.curProject].collab=v.toString();				// Combine into string
				Sound("delete");											// Delete
				sf.changed=true;											// Something changed
				sf.Draw();													// Redraw
				});
			});

for (i=0;i<30;++i) $("#item-"+i).draggable({ revert:true});

	}
}	
	
folio.prototype.MakeProjectPage=function()								// MAKE PROJECT PAGE
{
	var pTitle="",pDesc="",pCite="",pTags="",pCollab=[];
	var str="<br>"
	str+="<div id='projectDiv' class='sf-projectPage'>";					// Project container
	if (this.curProject < 0) 												// No project selected
		return "</div>"+str;												// Return empty page
	if (projects[this.curProject].title)  pTitle=projects[this.curProject].title;
	if (projects[this.curProject].desc)   pDesc=projects[this.curProject].desc;
	if (projects[this.curProject].cite)   pCite=projects[this.curProject].cite;
	if (projects[this.curProject].tags)   pTags=projects[this.curProject].tags;
	if (projects[this.curProject].collab) pCollab=projects[this.curProject].collab.split(",");
	str+="<table style='width:100%'>";
	str+="<tr height='32'><td width='1%'>Title</td>";
	str+="<td><input class='sf-is' id='pTitle' ";
	str+="type='text' value='"+pTitle+"'></td></tr>";
	str+="<tr height='28'><td>Description</td><td><textarea class='sf-is' id='pDesc' ";
	str+="style='font-family:sans-serif'>"+pDesc+"</textarea></td></tr>";
	str+="<tr height='28'><td>Citation</td>";
	str+="<td><input class='sf-is' id='pCitation' ";
	str+="type='text' value='"+pCite+"'></td></tr>";
	str+="<tr height='28'><td>Tags</td>";
	str+="<td><input class='sf-is' id='pTags' ";
	str+="type='text' value='"+pTags+"'></td></tr>";
	str+="<tr height='28'><td>Collaborators&nbsp;&nbsp;</td>";
	str+="<td>"+MakeSelect("pCollab",false,pCollab);
	str+="<img id='collabAddBut' class='sf-galleryBut' src='img/addbut.gif' style='vertical-align:-4px;margin-left:20px;margin-right:10px'>";
	str+="<img id='collabTrashBut' class='sf-galleryBut' src='img/trashbut.gif' style='vertical-align:-4px;margin-right:0px'></td></tr>";
	str+="</table><br>";
	str+="<div id='projectItemsDiv' class='sf-projectItems'>";
	str+="<p style='text-align:center'>Drag items to include in project here</p></div>";
	return "</div>"+str;													// Return project page
}	
	
folio.prototype.MakeItemsPicker=function()								// MAKE ITEMS PICKER
{
	var str="<div id='itemPickerDiv' class='sf-itemsPicker'>";				// Item picker container
	if (this.curProject < 0) 												// No project selected
		return "</div>"+str;												// Return empty page
	str+="<div style='text-align:center'>Filter items by &nbsp;";			// Label
	str+="<input type='text' class='sf-is' id='pFilter' style='width:150px'</div><br><br>"; // Filter

var v=["webitem","imageitem","qmediaitem","kalturaitem","mapitem","wordpressitem"];

	for (i=0;i<30;++i) {
		str+="<div id='item-"+i+"' class='sf-item'>";
		pic=v[Math.round((Math.random()*5))];
		str+="<img src='img/"+pic+".png' class='sf-itemPic';>Item "+(i+1)+"'s title</div>";
		}
	return "</div>"+str;													// Return prokect page
}	


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// HELPERS
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function MakeGallery()													// MAKE GALLERY WIDGET
{
	var i,o,labs=[];
	var h=$("#bodyDiv").height()-60;											
	var trsty=" onMouseOver='this.style.backgroundColor=\"#dee7f1\"' ";
	trsty+="onMouseOut='this.style.backgroundColor=\"#f8f8f8\"'";
	var title=sf.page.substr(0,1).toUpperCase()+sf.page.substr(1)+"s";
	var str="<div id='gallery' class='sf-gallery'><p><b>"+title+"</b></p>";
	str+="<div class='sf-galleryContent' style='height:"+(h-20)+"px'>";		// Scrollable container
	
	
	if (sf.page == "project") {												// Project gallery
		for (i=0;i<projects.length;++i) {
			labs[i]=projects[i].title;
			str+="<div id='galleryLab"+i+"'"+trsty+" class='sf-galleryLab'><span"
			if (i == sf.curProject)											// If the current project
				str+=" style='color:#009900'"								// Color it
			str+=">"+labs[i]+"</span></div>";								// Close
			}
		}
	str+="</div>";
	str+="<div style='position:relative;text-align:center;margin-top:8px'>";
	str+"</div>";
	str+="<div class='sf-galleryTool'>";
	str+="<img id='galleryAddBut' class='sf-galleryBut' src='img/addbut.gif'>";
	str+="<img id='galleryCartBut' class='sf-galleryBut'src='img/cartbut.gif'>";
	str+="<img id='gallerySettingsBut' class='sf-galleryBut' src='img/settingsbut.gif'>";
	str+="<img id='galleryTrashBut' class='sf-galleryBut' src='img/trashbut.gif' style='margin-right:0px'>";
	str+="</div>";
	return str+"</div>";
	}

	function MakeSelect(id, multi, items, sel, extra, values)				// CREATE HTML SELECT
	{
		var	str="<select class='sf-is' id='"+id+"'";							// Header
		str+="style='width:auto'";
		if (multi)																// Multi select
			str+="multiple='multiple' size='"+multi+"'";						// Add flag
		if (extra)																// If extra param
			str+=extra;															// Add them
		str+=">";																// End header
		for (i=0;i<items.length;++i) {											// For each option
			str+="<option";														// Add tag
			if (sel == items[i])												// If selected
				str+=" selected='selected'"										// Add tag
			if (values && values[i])											// If has a value
				str+=" value='"+values[i]+"'";									// Add it
			str+=">"+items[i]+"</option>";										// End option
			}	
		return str+"</select>";													// End select				
	}


	function Sound(sound, mode)												// PLAY SOUND
	{	
		var snd=new Audio();
		if (!snd.canPlayType("audio/mpeg"))
			snd=new Audio(sound+".ogg");
		else	
			snd=new Audio(sound+".mp3");
		if (mode != "init")
			snd.play();
		}

	function SetCookie(cname, cvalue, exdays)								// SET COOKIE
	{
		var d=new Date();
		d.setTime(d.getTime()+(exdays*24*60*60*1000));
		var expires = "expires="+d.toGMTString();
		document.cookie = cname + "=" + cvalue + "; " + expires;
	}
	
	function GetCookie(cname) 												// GET COOKIE
	{
		var name=cname+"=",c;
		var ca=document.cookie.split(';');
		for (var i=0;i<ca.length;i++)  {
		  c=ca[i].trim();
		  if (c.indexOf(name) == 0) 
		  	return c.substring(name.length,c.length);
		  }
		return "";
	}

	function AlertBox(title, content, callback)								// ALERT BOX
	{
		$("#alertBoxDiv").remove();												
		Sound("delete");														
		$("body").append("<div class='unselectable' id='alertBoxDiv'></div>");														
		var str="<p><img src='img/shantilogo32.png' style='vertical-align:-10px'/>&nbsp;&nbsp;";								
		str+="<span style='font-size:18px;text-shadow:1px 1px #ccc;color:#990000'><b>"+title+"</b></span></p>";
		str+="<div style='font-size:14px;margin:16px'>"+content+"</div>";
		$("#alertBoxDiv").append(str);	
		$("#alertBoxDiv").dialog({ width:400, buttons:{"OK": function() { $(this).remove(); if (callback) callback(); }}});	
		$(".ui-dialog-titlebar").hide();
		$(".ui-dialog-buttonpane.ui-widget-content.ui-helper-clearfix").css("border","none");
		$(".ui-dialog").css({"border-radius":"14px", "box-shadow":"4px 4px 8px #ccc"});
  		$(".ui-button").css({"border-radius":"30px","outline":"none"});
	}

	function ConfirmBox(content, callback)									// COMFIRM BOX
	{
		Sound("click");														
		$("#alertBoxDiv").remove();												
		$("body").append("<div class='unselectable' id='alertBoxDiv'></div>");														
		var str="<p><img src='img/shantilogo32.png' style='vertical-align:-10px'/>&nbsp;&nbsp;";								
		str+="<span style='font-size:18px;text-shadow:1px 1px #ccc;color:#990000'><b>Are you sure?</b></span><p>";
		str+="<div style='font-size:14px;margin:14px'>"+content+"</div>";
		$("#alertBoxDiv").append(str);	
		$("#alertBoxDiv").dialog({ width:400, buttons: {
					            	"Yes": function() { $(this).remove(); callback() },
					            	"No":  function() { $(this).remove(); }
									}});	
		$(".ui-dialog-titlebar").hide();
		$(".ui-dialog-buttonpane.ui-widget-content.ui-helper-clearfix").css("border","none");
		$(".ui-dialog").css({"border-radius":"14px", "box-shadow":"4px 4px 8px #ccc"});
 		$(".ui-button").css({"border-radius":"30px","outline":"none"});
 	}

	function GetTextBox(title, content, def, callback)					// GET TEXT LINE BOX
	{
		Sound("click");														
		$("#alertBoxDiv").remove();											
		$("body").append("<div class='unselectable' id='alertBoxDiv'></div>");														
		var str="<p><img src='img/shantilogo32.png' style='vertical-align:-10px'/>&nbsp;&nbsp;";								
		str+="<span id='gtBoxTi'style='font-size:18px;text-shadow:1px 1px #ccc;color:#990000'><b>"+title+"</b></span><p>";
		str+="<div style='font-size:14px;margin:14px'>"+content;
		str+="<p><input class='sf-is' type='text' id='gtBoxTt' value='"+def+"'></p></div>";
		$("#alertBoxDiv").append(str);	
		$("#alertBoxDiv").dialog({ width:400, buttons: {
					            	"OK": 		function() { callback($("#gtBoxTt").val()); $(this).remove(); },
					            	"Cancel":  	function() { $(this).remove(); }
									}});	
		$(".ui-dialog-titlebar").hide();
		$(".ui-dialog-buttonpane.ui-widget-content.ui-helper-clearfix").css("border","none");
		$(".ui-dialog").css({"border-radius":"14px", "box-shadow":"4px 4px 8px #ccc"});
 		$(".ui-button").css({"border-radius":"30px","outline":"none"});
 	}

	function ShortenString(str, len)									// SHORTEN A STRING TO LENGTH
	{
		if (str.length > len)												// Too long
			str=str.substr(0,(len-3)/2)+"..."+str.slice((len-3)/-2);			// Shorten	
		return str;															// Return string
	}

	function trace(msg, p1, p2, p3, p4)										// CONSOLE 
	{
		if (p4 != undefined)
			console.log(msg,p1,p2,p3,p4);
		else if (p3 != undefined)
			console.log(msg,p1,p2,p3);
		else if (p2 != undefined)
			console.log(msg,p1,p2);
		else if (p1 != undefined)
			console.log(msg,p1);
		else
			console.log(msg);
		}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// DATA
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var items=[ {
	type:"Kaltura",
	src:"kaltura_player_1_c7z7zuiv",
	thumb:"https://cfvod.kaltura.com/p/343772/sp/34377200/thumbnail/entry_id/1_c7z7zuiv/version/100011/acv/121",
	title:"Hip Voter video",
	desc:"A video to encourage millenial voting",
	citation:"(c) 2015 University of Virginia www.hipvoter.com",
	startDate:"12/12/2015",
	placeName:"Charlottesville, VA",
	permissions:"r",
	autoStart:"false",
	start:"0",
	end:"1:45",
	volume:"50"
	}
];
	
var projects=[ 
	{
	title:"Hip voting",
	desc:"To educate and empower Millennials on the American political system in preparation for the 2016 Presidential Election. The goal is educate about the political structure of the US, the voting process, and prevalent issues in the US today in order to drive young individuals to vote.",
	cite:"(c) 2016 University of Virginia www.hipvoter.com",
	tags:"Politics, MDST 3703",
	collab:"Mike, James, Hanna, Michelle"
	},
	{
	title:"A tale of two tours",
	desc:"Welcome to our Tale of Two Tours where we will lead you through a digital experience of Paul McCartney's 1989 World Tour and his 2009 Summer Tour. Here you will find setlist information, tour member biographies, and individual concert facts.",
	cite:"(c) 2016 University of Virginia",
	tags:"Entertainment, MDST 3703",
	collab:"Imani, Ashlyn, Liz"
	}
];
			
	






</script>
</body>
</html>
	
